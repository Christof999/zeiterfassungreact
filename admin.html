<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lauffer Zeiterfassung - Admin</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="admin.css">
    <link rel="stylesheet" href="gallery.css">
    <link rel="stylesheet" href="time-entries.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <h1>Lauffer Zeiterfassung</h1>
                <p>Gartenbau • Erdbau • Natursteinhandel</p>
            </div>
        </header>

        <main>
            <div id="admin-login-section" class="section">
                <h2>Admin Anmeldung</h2>
                <form id="admin-login-form">
                    <div class="form-group">
                        <label for="admin-username">Benutzername:</label>
                        <input type="text" id="admin-username" required>
                    </div>
                    <div class="form-group">
                        <label for="admin-password">Passwort:</label>
                        <input type="password" id="admin-password" required>
                    </div>
                    <button type="submit" class="btn primary-btn">Anmelden</button>
                </form>
                <p class="user-link"><a href="index.html">Zur Mitarbeiter-Ansicht</a></p>
            </div>

            <div id="admin-dashboard" class="section hidden">
                <div class="admin-header">
                    <h2>Admin Dashboard</h2>
                    <div class="admin-controls">
                        <span id="admin-name"></span>
                        <button id="admin-logout-btn" class="btn secondary-btn">Abmelden</button>
                    </div>
                </div>

                <div class="dashboard-tabs">
                    <button class="tab-btn active" data-tab="overview">Übersicht</button>
                    <button class="tab-btn" data-tab="employees">Mitarbeiter</button>
                    <button class="tab-btn" data-tab="projects">Projekte</button>
                    <button class="tab-btn" data-tab="reports">Berichte</button>
                </div>

                <div id="overview-tab" class="tab-content active">
                    <h3>Übersicht</h3>
                    <div class="dashboard-stats">
                        <div class="stat-card">
                            <h4>Aktive Mitarbeiter</h4>
                            <p id="active-employees-count">0</p>
                        </div>
                        <div class="stat-card">
                            <h4>Laufende Projekte</h4>
                            <p id="active-projects-count">0</p>
                        </div>
                        <div class="stat-card">
                            <h4>Heutige Arbeitsstunden</h4>
                            <p id="today-hours">0h</p>
                        </div>
                    </div>

                    <div class="live-activity">
                        <h4>Live Aktivität</h4>
                        <div class="activity-table-container">
                            <table id="live-activity-table">
                                <thead>
                                <tr>
                                    <th>Mitarbeiter</th>
                                    <th>Projekt</th>
                                    <th>Status</th>
                                    <th>Seit</th>
                                    <th>Standort</th>
                                    <th>Aktionen</th>
                                </tr>
                            </thead>
                                <tbody>
                                    <!-- Wird durch JavaScript gefüllt -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div id="employees-tab" class="tab-content">
                    <div class="tab-header">
                        <h3>Mitarbeiterverwaltung</h3>
                        <button id="add-employee-btn" class="btn primary-btn">
                            <i class="fas fa-plus"></i> Neuer Mitarbeiter
                        </button>
                    </div>

                    <div class="employee-table-container">
                        <table id="employees-table">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Benutzername</th>
                                    <th>Position</th>
                                    <th>Status</th>
                                    <th>Aktionen</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Wird durch JavaScript gefüllt -->
                            </tbody>
                        </table>
                    </div>

                    <div id="employee-form-modal" class="modal">
                        <div class="modal-content">
                            <span class="close-modal">&times;</span>
                            <h3 id="employee-form-title">Mitarbeiter hinzufügen</h3>
                            <form id="employee-form">
                                <input type="hidden" id="employee-id">
                                <div class="form-group">
                                    <label for="employee-name">Name:</label>
                                    <input type="text" id="employee-name" required>
                                </div>
                                <div class="form-group">
                                    <label for="employee-username">Benutzername:</label>
                                    <input type="text" id="employee-username" required>
                                </div>
                                <div class="form-group">
                                    <label for="employee-password">Passwort:</label>
                                    <input type="password" id="employee-password" required>
                                </div>
                                <div class="form-group">
                                    <label for="employee-position">Position:</label>
                                    <input type="text" id="employee-position" required>
                                </div>
                                <div class="form-group">
                                    <label for="employee-status">Status:</label>
                                    <select id="employee-status">
                                        <option value="active">Aktiv</option>
                                        <option value="inactive">Inaktiv</option>
                                    </select>
                                </div>
                                <div class="form-actions">
                                    <button type="button" class="btn secondary-btn cancel-btn">Abbrechen</button>
                                    <button type="submit" class="btn primary-btn">Speichern</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <div id="projects-tab" class="tab-content">
                    <div class="tab-header">
                        <h3>Projektverwaltung</h3>
                        <button id="add-project-btn" class="btn primary-btn">
                            <i class="fas fa-plus"></i> Neues Projekt
                        </button>
                    </div>

                    <div class="project-table-container">
                        <table id="projects-table">
                            <thead>
                                <tr>
                                    <th>Projektname</th>
                                    <th>Kunde</th>
                                    <th>Startdatum</th>
                                    <th>Enddatum</th>
                                    <th>Status</th>
                                    <th>Aktionen</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Wird durch JavaScript gefüllt -->
                            </tbody>
                        </table>
                    </div>

                    <div id="project-form-modal" class="modal">
                        <div class="modal-content">
                            <span class="close-modal">&times;</span>
                            <h3 id="project-form-title">Projekt hinzufügen</h3>
                            <form id="project-form">
                                <input type="hidden" id="project-id">
                                <div class="form-group">
                                    <label for="project-name">Projektname:</label>
                                    <input type="text" id="project-name" required>
                                </div>
                                <div class="form-group">
                                    <label for="project-client">Kunde:</label>
                                    <input type="text" id="project-client" required>
                                </div>
                                <div class="form-group">
                                    <label for="project-start-date">Startdatum:</label>
                                    <input type="date" id="project-start-date" required>
                                </div>
                                <div class="form-group">
                                    <label for="project-end-date">Enddatum (geplant):</label>
                                    <input type="date" id="project-end-date">
                                </div>
                                <div class="form-group">
                                    <label for="project-description">Beschreibung:</label>
                                    <textarea id="project-description" rows="3"></textarea>
                                </div>
                                <div class="form-group">
                                    <label for="project-address">Standort-Adresse:</label>
                                    <input type="text" id="project-address" placeholder="Straße, Nr, PLZ, Ort">
                                </div>
                                <div class="form-group map-container">
                                    <div id="project-map" style="height: 200px; width: 100%; border-radius: 4px;"></div>
                                    <input type="hidden" id="project-latitude">
                                    <input type="hidden" id="project-longitude">
                                    <button type="button" id="locate-project-btn" class="btn secondary-btn">Standort suchen</button>
                                </div>
                                <div class="form-group">
                                    <label for="project-status">Status:</label>
                                    <select id="project-status">
                                        <option value="planned">Geplant</option>
                                        <option value="active">Aktiv</option>
                                        <option value="completed">Abgeschlossen</option>
                                        <option value="archived">Archiviert</option>
                                    </select>
                                </div>
                                <div class="form-actions">
                                    <button type="button" class="btn secondary-btn cancel-btn">Abbrechen</button>
                                    <button type="submit" class="btn primary-btn">Speichern</button>
                                </div>
                            </form>
                        </div>
                    </div>
                    
                    <!-- Projektdetail-Modal für Dateianzeige -->
                    <div id="project-detail-modal" class="modal">
                        <div class="modal-content large-modal">
                            <div class="modal-header">
                                <h3 id="project-detail-title">Projektdetails</h3>
                                <button type="button" class="close-modal-btn">&times;</button>
                            </div>
                            <div class="modal-body">
                                <div class="project-info-container">
                                    <h4>Projektinformationen</h4>
                                    <div class="project-info-grid">
                                        <div class="info-item">
                                            <strong>Kunde:</strong>
                                            <span id="detail-client"></span>
                                        </div>
                                        <div class="info-item">
                                            <strong>Zeitraum:</strong>
                                            <span id="detail-timeframe"></span>
                                        </div>
                                        <div class="info-item">
                                            <strong>Status:</strong>
                                            <span id="detail-status"></span>
                                        </div>
                                        <div class="info-item">
                                            <strong>Standort:</strong>
                                            <span id="detail-location"></span>
                                        </div>
                                    </div>
                                    <div class="info-description">
                                        <strong>Beschreibung:</strong>
                                        <p id="detail-description"></p>
                                    </div>
                                </div>
                                
                                <div class="project-tabs">
                                    <button class="project-tab-btn active" data-tab="construction-site">Baustellenfotos</button>
                                    <button class="project-tab-btn" data-tab="documents">Lieferscheine & Rechnungen</button>
                                    <button class="project-tab-btn" data-tab="timeentries">Zeiteinträge</button>
                                </div>
                                
                                <div class="project-tab-content active" id="construction-site-tab">
                                    <div class="filter-controls">
                                        <input type="date" id="site-photos-date-filter" placeholder="Nach Datum filtern">
                                        <select id="site-photos-employee-filter">
                                            <option value="all">Alle Mitarbeiter</option>
                                        </select>
                                        <button id="clear-site-photos-filter" class="btn secondary-btn">Filter zurücksetzen</button>
                                    </div>
                                    <div class="gallery-container" id="site-photos-gallery">
                                        <!-- Wird per JavaScript gefüllt -->
                                    </div>
                                </div>
                                
                                <div class="project-tab-content" id="documents-tab">
                                    <div class="filter-controls">
                                        <input type="date" id="docs-date-filter" placeholder="Nach Datum filtern">
                                        <select id="docs-employee-filter">
                                            <option value="all">Alle Mitarbeiter</option>
                                        </select>
                                        <button id="clear-docs-filter" class="btn secondary-btn">Filter zurücksetzen</button>
                                    </div>
                                    <div class="gallery-container" id="documents-gallery">
                                        <!-- Wird per JavaScript gefüllt -->
                                    </div>
                                </div>
                                
                                <div class="project-tab-content" id="timeentries-tab">
                                    <div class="filter-controls">
                                        <input type="date" id="time-date-filter" placeholder="Nach Datum filtern">
                                        <select id="time-employee-filter">
                                            <option value="all">Alle Mitarbeiter</option>
                                        </select>
                                        <button id="clear-time-filter" class="btn secondary-btn">Filter zurücksetzen</button>
                                    </div>
                                    <div class="time-entries-table-container">
                                        <table id="time-entries-table" class="data-table">
                                            <thead>
                                                <tr>
                                                    <th>Mitarbeiter</th>
                                                    <th>Datum</th>
                                                    <th>Einstempelzeit</th>
                                                    <th>Ausstempelzeit</th>
                                                    <th>Arbeitszeit</th>
                                                    <th>Notizen</th>
                                                    <th>Aktionen</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <!-- Wird per JavaScript gefüllt -->
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Bild-Vorschau-Modal für vergrößerte Ansicht -->
                    <div id="image-preview-modal" class="modal">
                        <div class="modal-content image-preview-modal">
                            <button type="button" class="close-modal-btn">&times;</button>
                            <div class="image-preview-container">
                                <img id="preview-image" src="" alt="Vergrößerte Ansicht">
                                <div class="image-preview-info">
                                    <p><strong>Datum:</strong> <span id="preview-date"></span></p>
                                    <p><strong>Mitarbeiter:</strong> <span id="preview-employee"></span></p>
                                    <p><strong>Notizen:</strong> <span id="preview-notes"></span></p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Modal für das Einstempeln von Mitarbeitern -->
                <div id="clock-in-employee-modal" class="modal">
                    <div class="modal-content">
                        <span class="close-modal">&times;</span>
                        <h3>Mitarbeiter einstempeln</h3>
                        <form id="clock-in-employee-form">
                            <input type="hidden" id="clock-in-employee-id">
                            <div class="form-group">
                                <label for="clock-in-employee-name">Mitarbeiter:</label>
                                <input type="text" id="clock-in-employee-name" readonly>
                            </div>
                            <div class="form-group">
                                <label for="clock-in-project">Projekt:</label>
                                <select id="clock-in-project" required>
                                    <!-- Wird durch JavaScript gefüllt -->
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="clock-in-notes">Notizen:</label>
                                <textarea id="clock-in-notes" rows="3"></textarea>
                            </div>
                            <div class="form-group map-container">
                                <label>Standort:</label>
                                <div id="clock-in-map" style="height: 200px; width: 100%; border-radius: 4px;"></div>
                                <input type="hidden" id="clock-in-latitude">
                                <input type="hidden" id="clock-in-longitude">
                                <button type="button" id="locate-current-btn" class="btn secondary-btn">Aktuellen Standort verwenden</button>
                            </div>
                            <div class="form-actions">
                                <button type="button" class="btn secondary-btn cancel-btn">Abbrechen</button>
                                <button type="submit" class="btn primary-btn">Einstempeln</button>
                            </div>
                        </form>
                    </div>
                </div>
                
                <!-- Modal für das Ausstempeln von Mitarbeitern -->
                <div id="clock-out-employee-modal" class="modal">
                    <div class="modal-content">
                        <span class="close-modal">&times;</span>
                        <h3>Mitarbeiter ausstempeln</h3>
                        <form id="clock-out-employee-form">
                            <input type="hidden" id="clock-out-employee-id">
                            <div class="form-group">
                                <label for="clock-out-employee-name">Mitarbeiter:</label>
                                <input type="text" id="clock-out-employee-name" readonly>
                            </div>
                            <div class="form-group">
                                <label for="clock-out-project">Projekt:</label>
                                <input type="text" id="clock-out-project" readonly>
                            </div>
                            <div class="form-group">
                                <label for="clock-out-notes">Notizen:</label>
                                <textarea id="clock-out-notes" rows="3"></textarea>
                            </div>
                            <div class="form-group map-container">
                                <label>Standort:</label>
                                <div id="clock-out-map" style="height: 200px; width: 100%; border-radius: 4px;"></div>
                                <input type="hidden" id="clock-out-latitude">
                                <input type="hidden" id="clock-out-longitude">
                                <button type="button" id="locate-clock-out-btn" class="btn secondary-btn">Aktuellen Standort verwenden</button>
                            </div>
                            <div class="form-actions">
                                <button type="button" class="btn secondary-btn cancel-btn">Abbrechen</button>
                                <button type="submit" class="btn primary-btn">Ausstempeln</button>
                            </div>
                        </form>
                    </div>
                </div>

                <div id="reports-tab" class="tab-content">
                    <h3>Berichte</h3>
                    
                    <div class="reports-modules">
                        <div class="report-module">
                            <h4>Mitarbeiter-Zeitberichte</h4>
                            <p>Erstellen Sie detaillierte Berichte über die Arbeitszeiten und Projekte einzelner Mitarbeiter für einen bestimmten Zeitraum.</p>
                            <p>Exportieren Sie die Daten als CSV oder PDF für die Weitergabe oder Archivierung.</p>
                            <a href="employee-reports.html" class="btn primary-btn">
                                <i class="fas fa-user-clock"></i> Mitarbeiter-Zeitberichte öffnen
                            </a>
                        </div>
                        
                        <div class="report-module">
                            <h4>Projektberichte</h4>
                            <p>Sehen Sie alle Arbeitszeiten, Bilder und Dokumente zu einem bestimmten Projekt.</p>
                            <p>Exportieren Sie die vollständigen Projektinformationen als PDF.</p>
                            <a href="project-simple.html" class="btn primary-btn">
                                <i class="fas fa-building"></i> Projektberichte öffnen
                            </a>
                        </div>

                        <div class="report-module disabled">
                            <h4>Erweiterte Berichte (in Entwicklung)</h4>
                            <p>Bald verfügbar: Benutzerdefinierte Berichte, Zusammenfassungen, Grafiken und mehr.</p>
                            <button class="btn secondary-btn" disabled>
                                <i class="fas fa-chart-line"></i> Demnächst verfügbar
                            </button>
                        </div>
                    </div>
                    
                    <style>
                        .reports-modules {
                            display: flex;
                            flex-wrap: wrap;
                            gap: 20px;
                            margin-top: 20px;
                        }
                        
                        .report-module {
                            flex: 1;
                            min-width: 300px;
                            padding: 20px;
                            background-color: #f9f9f9;
                            border-radius: 5px;
                            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
                        }
                        
                        .report-module h4 {
                            color: #5e8c2f;
                            margin-top: 0;
                        }
                        
                        .report-module p {
                            margin-bottom: 15px;
                            color: #555;
                        }
                        
                        .report-module.disabled {
                            opacity: 0.7;
                            background-color: #f0f0f0;
                        }
                        
                        .report-module .btn {
                            display: inline-flex;
                            align-items: center;
                            margin-top: 10px;
                        }
                        
                        .report-module .btn i {
                            margin-right: 8px;
                        }
                    </style>
                </div>
            </div>
        </main>

        <footer>
            <p>&copy; 2025 Lauffer Gartenbau Erdbau Natursteinhandel</p>
        </footer>
    </div>

    <!-- Firebase SDKs -->    
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"></script>
    
    <!-- App JavaScript -->    
    <script src="firebase-config.js"></script>
    <script src="config.js"></script>
    <script src="data.js"></script>
    <!-- Hier Ihren Google Maps API-Key eintragen (ersetzen Sie YOUR_API_KEY mit Ihrem tatsächlichen Key) -->
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBC1ROorGCf3g3ja3wlTLF6oYuEb1pio8I&libraries=places" async></script>
    
    <!-- Vereinfachte Admin JS Datei für grundlegende Anmeldung -->
    <script src="admin-minimal.js?v=1.0.1"></script>
    
    <!-- Nur Admin-Funktionen, Berichtsanzeige entfernt -->
</body>
</html>
